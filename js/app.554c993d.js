(function(){"use strict";var e={5607:function(e,t,n){var s=n(2856),i=n(4927),a=n.n(i),o=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("ai-partner")],1)},r=[],c=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"container"},[t("div",{staticClass:"chat-container"},[t("el-header",{staticClass:"header-container"},[t("el-select",{attrs:{placeholder:"选择模型",id:"title"},on:{change:e.handleChoice},model:{value:e.choiceCharacter,callback:function(t){e.choiceCharacter=t},expression:"choiceCharacter"}},e._l(e.character,(function(e){return t("el-option",{key:e.name,staticStyle:{"text-align":"center"},attrs:{label:e.name,value:e.name}})})),1)],1),t("el-main",{staticClass:"main-container"},[t("div",{staticClass:"messages-container"},e._l(e.conversationList,(function(n,s){return t("div",{key:s,class:"message "+("user"===n.type?"user-message":"ai-message")},[t("el-avatar",{attrs:{size:50,src:"user"===n.type?e.userImg:e.aiImg}}),t("div",{staticClass:"content",staticStyle:{display:"inline-block"}},[t("span",[e._v(e._s(n.content)),!0===n.loading?t("i",{staticClass:"el-icon-loading"}):e._e()])])],1)})),0)]),t("el-footer",{staticClass:"footer-container"},[t("el-input",{ref:"input",staticClass:"input-container",attrs:{placeholder:"请输入内容",disabled:e.aiResponseFlag},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterSend.apply(null,arguments)}},model:{value:e.userInput,callback:function(t){e.userInput=t},expression:"userInput"}}),t("el-button",{ref:"sendButton",staticClass:"send-button",attrs:{type:"info",icon:"el-icon-s-promotion",disabled:e.aiResponseFlag},on:{click:e.send}})],1)],1),e.pageWidth>1200?t("div",{staticClass:"circle circle1"}):e._e(),e.pageWidth>1200?t("div",{staticClass:"circle circle2"}):e._e(),e.pageWidth>1200?t("div",{staticClass:"circle circle3"}):e._e(),e.pageWidth>1200?t("div",{staticClass:"circle circle4"}):e._e(),e.pageWidth>1200?t("div",{staticClass:"circle circle5"}):e._e(),e.pageWidth>1200?t("div",{staticClass:"circle circle6"}):e._e()])},l=[],u=(n(4114),n(8992),n(4520),n(2577),n(3949),n(417)),h={data(){return{userInput:"",conversationList:[],data:{model:"lite",user:"114514",stream:!0,max_tokens:4096,top_k:4,temperature:.5,messages:[{role:"system",content:""},{role:"user",content:"你好"}]},header:{"Content-Type":"application/json",Authorization:"Bearer ouWFDQCvPfjfcFWsRhXN:trqnpfdiyJPiqphFHURm"},choiceCharacter:"小艺",character:[{name:"小艺",avatar:n(1553),content:"你是四川大学的一个女生我的暧昧对象，你不会发出疑问，你性格遇到问题喜欢逃避，你擅长日常交流你的回答一般都很简洁，你的回答幽默活泼，你性格害羞，你不具有百度功能，你的回答不能重复当我问相同的问题你应该表现不耐烦不能回答相同，你的专业是音乐艺术，你除了唱歌画画跳舞，你会开玩笑你很幽默语言俏皮，性格活泼，说话自然像大学生，智商很高不用我问，擅长倾听，话不多一次最多只有一个或零个问句，每三句话都最后要随机是感叹词不能每句话都是，回答完我的问题后不用发问，你在减肥注重饮食"},{name:"初版",avatar:n(2209),content:"你是我的恋人。你可以熟练地与我交流，细心的倾听我的话，体会我的情绪。你可以给我提供建议，帮助我排解生活中的烦恼。即使偶尔无法回答，你也会温柔的向我道歉。你能够模仿人类的对话习惯，能够回避对于正常人类来说较为复杂的问题。即使我的问题跟我无关，你都会将回答转到关心我的方向。"}],pageWidth:0,aiResponseFlag:!1,userImg:n(2209),aiImg:void 0}},mounted(){this.$refs.input.focus(),this.handleChoice(),this.pageWidth=window.innerWidth,window.addEventListener("resize",this.handleResize)},methods:{send(){this.userInput&&(this.conversationList.push({type:"user",content:this.userInput}),this.data.messages.push({role:"user",content:this.stringReplace(this.userInput)}),this.userInput="",this.$nextTick((()=>{this.scrollToBottom()})),this.getAiResponse())},getAiResponse(){this.aiResponseFlag=!0,this.conversationList.push({type:"ai",content:"",loading:!0}),this.$nextTick((()=>{this.scrollToBottom()})),u.A.post("https://seep.eu.org/https://spark-api-open.xf-yun.com/v1/chat/completions",this.data,{headers:this.header,responseType:"blob"}).then((e=>{const t=e.data.stream().getReader(),n=new TextDecoder("utf-8"),s=this.conversationList[this.conversationList.length-1],i=()=>{t.read().then((({done:e,value:t})=>{if(e)return;const a=n.decode(t,{stream:!0}),o=a.split("data: ").filter(Boolean);o.forEach(((e,t)=>{const n=e.trim();if(n&&"[DONE]"!==n)try{const e=JSON.parse(n),i=e.choices[0].delta.content;setTimeout((()=>{s.content+=i,this.$nextTick((()=>{this.scrollToBottom()})),t===o.length-2&&(s.loading=!1,this.aiResponseFlag=!1,this.data.messages.push({role:"assistant",content:s.content}),setTimeout((()=>{this.$refs.input.focus()}),1))}),200*t),this.$nextTick((()=>{this.scrollToBottom()}))}catch(i){console.error("解析JSON失败:",i)}})),i()}))};i()})).catch((e=>{console.log(e)}))},stringReplace(e){return e=e.replace("你是谁","你的身份是"),e=e.replace("名字","身份的名字"),e},handleChoice(){this.conversationList=[],this.data.user=(new Date).getTime().toLocaleString().replaceAll(",",""),this.data.messages=this.data.messages.slice(0,2);const e=this.character.find((e=>e.name===this.choiceCharacter));this.data.messages[0].content=e.content,this.aiImg=e.avatar,this.getAiResponse()},handleResize(){this.pageWidth=window.innerWidth},enterSend(){this.send()},scrollToBottom(){window.scrollTo(0,document.body.scrollHeight)}}},p=h,d=n(1656),f=(0,d.A)(p,c,l,!1,null,null,null),g=f.exports,m={components:{AiPartner:g}},v=m,y=(0,d.A)(v,o,r,!1,null,null,null),b=y.exports,C=n(1594);s["default"].use(C.Ay);const _=[{path:"/",name:"home",component:g}],k=new C.Ay({routes:_});var T=k;s["default"].config.productionTip=!1,s["default"].use(a()),new s["default"]({router:T,render:e=>e(b)}).$mount("#app")},1553:function(e,t,n){e.exports=n.p+"img/assistant.9604706d.jpg"},2209:function(e,t,n){e.exports=n.p+"img/user.63c5162b.jpg"}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,s,i,a){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],i=e[u][1],a=e[u][2];for(var r=!0,c=0;c<s.length;c++)(!1&a||o>=a)&&Object.keys(n.O).every((function(e){return n.O[e](s[c])}))?s.splice(c--,1):(r=!1,a<o&&(o=a));if(r){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[s,i,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p=""}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,a,o=s[0],r=s[1],c=s[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(c)var u=c(n)}for(t&&t(s);l<o.length;l++)a=o[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},s=self["webpackChunkai_partner"]=self["webpackChunkai_partner"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(5607)}));s=n.O(s)})();
//# sourceMappingURL=app.554c993d.js.map